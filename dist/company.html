<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1"><meta http-equiv="X-UA-Compatible" content="ie=edge"><title>imageLabel</title><link rel="stylesheet" href="styles/main.css"><link rel="stylesheet" href="styles/edit.css"></head><body><button class="addpic">点击选择图片</button><div class="right-select-box"><div class="select-close"><svg t="1523862783721" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="3241" xmlns:xlink="http://www.w3.org/1999/xlink" width="20" height="20"><defs><style></style></defs><path d="M910.222222 796.444444c-17.066667 0-34.133333-5.688889-45.511111-17.066666L551.822222 409.6c-11.377778-5.688889-17.066667-11.377778-34.133333-11.377778-5.688889 0-22.755556 5.688889-28.444445 11.377778l-329.955555 364.088889c-22.755556 22.755556-56.888889 22.755556-79.644445 5.688889-22.755556-22.755556-22.755556-56.888889-5.688888-79.644445l329.955555-364.088889c28.444444-34.133333 73.955556-51.2 119.466667-51.2s85.333333 22.755556 119.466666 56.888889l312.888889 364.088889c22.755556 22.755556 17.066667 56.888889-5.688889 79.644445-11.377778 5.688889-28.444444 11.377778-39.822222 11.377777z" p-id="3242"></path></svg></div><div class="select-content"><div class="select-title flex-box"><div class="btns active">产品</div></div><div class="select-content-inner flex1 full-w"><ul class="inner-lists flex-box full-h"><li class="inner-list flex1 full-h products-list-body"><div class="form-body"><form id="select_form"><input type="text" placeholder="名称" name="name"> <input type="hidden" name="count" value="20"> <input type="hidden" name="currentpage" value="0"><div class="flex-box"><select name="category_id" class="flex1"><option value="">请选择类目</option></select> <select name="brand_id" class="flex1"><option value="">请选择产品</option></select> <button type="submit">搜索</button></div></form></div><ul class="products-lists"></ul><div class="ajax-loading"></div></li><li class="inner-list flex1 full-h"></li></ul></div></div></div><script id="module" type="text/html">{{each list $v i}}
        <li class="flex-box list" data-data='{{$v}}'>
            <div class='jiao'></div>
            <div class="cover-body">
                <img src="{{$v.pic}}" class="cover" alt="">
            </div>
            <div class="flex1 fonts">
                <div class='full-w'>
                    <div class="title ellipsis" title='{{$v.name}}'>{{$v.name}}</div>
                    <p class="ellipsis" title='{{$v.brand_name}}（{{$v.category_name}}'>{{$v.brand_name}}（{{$v.category_name}}）</p>
                    <p class="ellipsis">￥{{$v.price}}</p>
                </div>
            </div>
        </li>
        {{/each}}</script><script id="select_option" type="text/html">{{each category_list $v i}}
        <option value="{{$v.id}}">{{$v.name}}</option>
        {{/each}}</script><script id="select_option1" type="text/html">{{each brand_list $v i}}
        <option value="{{$v.id}}">{{$v.name}}</option>
        {{/each}}</script><script src="scripts/jquery.js"></script><script src="scripts/main.js"></script><script src="scripts/template.js"></script><script>$(function(){var t=$(".right-select-box"),s=$("#select_form");$(".addpic").click(function(){window.c=imageLabel({img:"http://imgshfs.test.upcdn.net/design/088/000/a92OhQJLAdckG7vxfEp1.jpg!l",only:!1,editPop:!1,d1ata:[{x:.16173752310536044,y:.27149916682465397,ex:.400184842883549,ey:.5359200850138197,product_id:821,name:1},{x:.5101663585951941,y:.18468928047575808,ex:.6081330868761553,ey:.3213899061056287,product_id:819,name:2},{x:.511090573012939,y:.4770490126622696,ex:.5878003696857671,ey:.6217321565770961,product_id:817,name:3}],close:function(t){return confirm("确定关闭吗？操作的数据有可能丢失哦！")},clickArea:function(){},edit:function(t){$(".right-select-box").addClass("select-active")},startArea:function(){},confirm:function(t){var e=!0;return $.each(t,function(t,a){a.product_id||(e=!1)}),e||alert("选区有未绑定产品的，请检查灰色块！"),e}})}),$(".select-close").click(function(){t.toggleClass("select-active")}),$(".select-title .btns").click(function(){var t=$(this);t.addClass("active").siblings().removeClass("active"),$(".inner-lists").css({marginLeft:-100*t.index()+"%"})});var i,n=$(".ajax-loading"),c=!0,r=!0,o=0;$(".products-list-body").scroll(function(){var t=$(this),a=t.scrollTop()+t.height();if($(".products-lists").height()<a+200&&c){c=!1;var e=Number(s.find("[name=currentpage]").val());s.find("[name=currentpage]").val(e+1),$.ajax({url:"http://shfs.wjkj.com/admin/api/pic/product/list",dataType:"json",type:"get",data:s.serializeArray(),success:function(t){1e3==t.code&&($(".products-lists").append(template("module",t.data)),i&&clearTimeout(i),o+=t.data.list.length,i=setTimeout(function(){0==t.data.params.total?(n.addClass("nothing"),c=!1):t.data.params.total>o?c=!0:(c=!1,n.addClass("over")),$(".products-list-body").scroll()},10),r&&($("#select_form [name=category_id]").append(template("select_option",t.data)),$("#select_form [name=brand_id]").append(template("select_option1",t.data))),r=!1)},error:function(){c=!0}})}}).scroll().on("click",".list",function(){var t=$(this),a=JSON.parse(t.attr("data-data")),e=$(".imageLabel-drop-edit");if(e.length){var s=JSON.parse(e.attr("data-json"));s.product_id=a.id,s.name=a.name,e.attr("data-json",JSON.stringify(s)),e.find("span").html(a.name),e.addClass("imageLabel-drop-has"),t.addClass("active")}}),$("#select_form").submit(function(t){$(this);return t.preventDefault(),s.find("[name=currentpage]").val(0),$(".products-lists").html(""),c=!0,o=0,n.removeClass("nothing over"),$(".products-lists").scroll(),!1}),setInterval(function(){var i=$(".imageLabel-drop-has"),t=$(".products-lists .list").removeClass("active");0<i.length&&t.each(function(t,a){var e=$(this),s=JSON.parse(e.attr("data-data"));i.each(function(t,a){JSON.parse($(a).attr("data-json")).product_id==s.id&&e.addClass("active")})})},1e3)})</script></body></html>